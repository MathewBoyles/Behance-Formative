function numberFormat(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function loadTmpl(e){$.ajax({url:"/tmpl/"+e+".html",success:function(e){$("body").append(e)}})}function loadHomepage(){homepageData.page++,$("#mixitup-loadmore").remove(),$.ajax({url:"http://www.behance.net/v2/users/"+config.user_id+"/projects",data:{client_id:config.client_id,per_page:12,page:homepageData.page},dataType:"jsonp",success:function(e){for(var t=0;t<e.projects.length;t++){for(var a=0;a<e.projects[t].fields.length;a++){var o=e.projects[t].fields[a];-1==homepageData.categories.indexOf(o)&&homepageData.categories.push(o),homepageData.categoriesCount[o]=homepageData.categoriesCount[o]?Number(homepageData.categoriesCount[o])+1:1}$el=$("<div />");for(var i=0;i<e.projects[t].fields.length;i++)$el.addClass("tag-"+e.projects[t].fields[i].replace(/ /g,"").replace(/[^\w\s]/gi,"").toLowerCase());$el.addClass("portfolio-item").addClass("col-md-3").data("projectData",e.projects[t]).append("<img />").find("img:last").addClass("portfolio-image").attr("src",e.projects[t].covers[404]).attr("alt",e.projects[t].name).parent().append("<div />").find("div:last").addClass("portfolio-title").text(e.projects[t].name).parent().click(showItem),$("#mixitup-container .row").append($el)}var l=Object.keys(homepageData.categoriesCount).sort(function(e,t){return homepageData.categoriesCount[e]-homepageData.categoriesCount[t]});l.reverse(),$("#mixitup-container .filters .btn:not(:eq(0))").remove();for(var r=0;r<l.length;r++)$el=$("<button />"),$el.addClass("btn").attr("type","button").attr("data-filter",".tag-"+l[r].replace(/ /g,"").replace(/[^\w\s]/gi,"").toLowerCase()).text(l[r]),r>3&&$el.addClass("hide"),$("#mixitup-container .filters").append($el),r==l.length-1&&l.length>4&&($("#mixitup-container .filters .btn.showmore, #mixitup-container .filters #mixitup-showless").remove(),$("#mixitup-container .filters").append("<button class='btn showmore' type='button'>Show more...</button>"),$("#mixitup-container .filters").append("<a id='mixitup-showless'>Show less</a>"));12==e.projects.length&&($el=$("<button />"),$el.addClass("btn").attr("type","button").attr("id","mixitup-loadmore").text("Load more...").click(loadHomepage),$("#mixitup-container").append($el)),$("#mixitup-container .filters .btn.showmore").click(function(){return $("#mixitup-container .filters").addClass("show"),!1}),$("#mixitup-showless").click(function(){return $("#mixitup-container .filters").removeClass("show"),!1}),homepageData.mixer&&homepageData.mixer.destroy(),homepageData.mixer=mixitup($("#mixitup-container"),{selectors:{target:".portfolio-item"},animation:{duration:300}}),$("#loading").fadeOut()},error:function(){console.log("something went wrong.")}})}function showItem(e){$("#loading").fadeIn(),isNaN(e)&&(e=$(this).data("projectData").id),$.ajax({url:"http://www.behance.net/v2/projects/"+e,data:{client_id:config.client_id},dataType:"jsonp",success:function(t){var a=t.project;$.ajax({url:"http://www.behance.net/v2/projects/"+e+"/comments",data:{client_id:config.client_id,per_page:20,page:1},dataType:"jsonp",success:function(e){a.comments=e.comments;var t=$("#portfolioPopup").html(),o=Template7.compile(t)(a);$("#portfolioPopupModal").remove(),$("body").append(o),$("#portfolioPopupModal").popup(),$("#loading").hide()}})}})}function initMap(){$.getJSON("/js/markers.json",function(e){for(var t={center:new google.maps.LatLng(35,10),zoom:2,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,draggable:!1,styles:[{featureType:"all",elementType:"labels",stylers:[{color:"#ff0000"},{visibility:"off"}]},{featureType:"all",elementType:"labels.text",stylers:[{color:"#c4c4c4"},{visibility:"off"}]},{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#c4c4c4"},{visibility:"off"}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#c4c4c4"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#c4c4c4"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{color:"#ff0000"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"},{color:"#c4c4c4"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{color:"#c4c4c4"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{color:"#c4c4c4"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"},{color:"#c4c4c4"}]},{featureType:"water",elementType:"all",stylers:[{color:"#ffffff"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels.text",stylers:[{color:"#c4c4c4"}]}]},a=new google.maps.Map(document.getElementById("map"),t),o=new google.maps.InfoWindow,i=0;i<e.length;i++){var l=new google.maps.Marker({position:{lat:e[i].coords.lat,lng:e[i].coords.lng},map:a});google.maps.event.addListener(l,"click",function(t,i){return console.log("test"),function(){o.setContent("<div class='infoWindowText'><h5>"+e[i].country+"</h5><br>"+e[i].address+"<br>Phone: "+e[i].phone+"<br>Email: <a href='mailto:"+e[i].email+"'>"+e[i].email+"</a></div>"),o.open(a,t)}}(l,i))}mapReady=!0,teamReady&&$("#loading").fadeOut()})}var config={user_id:"Lightfarm",client_id:"THVb3iZMcUlK7Qzh2qgcbCcxk0seZlpV"};loadTmpl("popup");var homepageData={categories:[],categoriesCount:{},mixer:null,page:0};"homepage"==$("body").attr("id")&&loadHomepage(1);var mapReady=!1;$.fn.popup=function(e,t){var a={backdrop:!0,click:!0,keyboard:!0},o=$.extend({},a,t);return"toggle"==e?(this.popup(this.is(":visible")?"hide":"show",t),this):(this.data({popupSettings:o}),this.find(".popup-backdrop").filter(function(){return!$(this).data("popupInit")}).data({popupInit:1}).click(function(){$(this).parent().data("popupSettings").click&&$(this).parent().popup("hide")}),"hide"==e?($("body").css("overflow","auto"),this.find(".popup-container").animate({top:0-1.5*this.find(".popup-container").height()}),this.find(".popup-backdrop").fadeOut(500,function(){$(this).parent().hide()})):"show"!=e&&e||($("body").css("overflow","hidden"),this.find(".popup-backdrop,.popup-container").hide(),this.show(),this.find(".popup-container").css({top:0-1.5*this.find(".popup-container").height()}).show().animate({top:"50%"}),this.data("popupSettings").backdrop?this.find(".popup-backdrop").fadeIn(500):this.find(".popup-backdrop").css({opacity:0}).show()),this)},$(document).keyup(function(e){27==e.keyCode&&$(".popup:visible").length&&$(".popup:visible").filter(function(){return $(this).data("popupSettings").keyboard}).popup("hide")});var teamReady=!1;"about"==$("body").attr("id")&&$.getJSON("/js/team.json",function(e){for(var t=$("#teamRows").html(),a=Template7.compile(t),o=[],i=0;i<e.length;i++){var l=e[i];l.lineBr=(i+1)%4==0,o.push(l)}var r=a({team:o});$("#teamRows").after(r),teamReady=!0,mapReady&&$("#loading").fadeOut()});