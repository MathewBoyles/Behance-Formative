$.fn.popup=function(p,i){return"toggle"==p?(this.popup(this.is(":visible")?"hide":"show",i),this):(this.find(".popup-backdrop").filter(function(){return!$(this).data("popupInit")}).data({popupInit:1}).click(function(){$(this).parent().popup("hide")}),"hide"==p?(this.find(".popup-container").animate({top:0-1.5*this.find(".popup-container").height()}),this.find(".popup-backdrop").fadeOut(500,function(){$(this).parent().hide()})):"show"!=p&&p||(this.find(".popup-backdrop,.popup-container").hide(),this.show(),this.find(".popup-container").css({top:0-1.5*this.find(".popup-container").height()}).show().animate({top:"50%"}),this.find(".popup-backdrop").fadeIn(500)),this)},$("#test-popup").popup("show");