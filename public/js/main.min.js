function numberFormat(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function loadTmpl(t){$.ajax({url:"/tmpl/"+t+".html",success:function(t){$("body").append(t)}})}function loadHomepage(){homepageData.page++,$("#mixitup-loadmore").remove(),$.ajax({url:"http://www.behance.net/v2/users/"+config.user_id+"/projects",data:{client_id:config.client_id,per_page:12,page:homepageData.page},dataType:"jsonp",success:function(t){for(var e=0;e<t.projects.length;e++){for(var o=0;o<t.projects[e].fields.length;o++){var a=t.projects[e].fields[o];-1==homepageData.categories.indexOf(a)&&homepageData.categories.push(a),homepageData.categoriesCount[a]=homepageData.categoriesCount[a]?Number(homepageData.categoriesCount[a])+1:1}$el=$("<div />");for(var i=0;i<t.projects[e].fields.length;i++)$el.addClass("tag-"+t.projects[e].fields[i].replace(/ /g,"").replace(/[^\w\s]/gi,"").toLowerCase());$el.addClass("portfolio-item").addClass("col-md-3").data("projectData",t.projects[e]).append("<img />").find("img:last").addClass("portfolio-image").attr("src",t.projects[e].covers[404]).attr("alt",t.projects[e].name).parent().append("<div />").find("div:last").addClass("portfolio-title").text(t.projects[e].name).parent().click(showItem),$("#mixitup-container .row").append($el)}var p=Object.keys(homepageData.categoriesCount).sort(function(t,e){return homepageData.categoriesCount[t]-homepageData.categoriesCount[e]});p.reverse(),$("#mixitup-container .filters .btn:not(:eq(0))").remove();for(var n=0;n<p.length;n++)$el=$("<button />"),$el.addClass("btn").attr("type","button").attr("data-filter",".tag-"+p[n].replace(/ /g,"").replace(/[^\w\s]/gi,"").toLowerCase()).text(p[n]),n>3&&$el.addClass("hide"),$("#mixitup-container .filters").append($el),n==p.length-1&&p.length>4&&($("#mixitup-container .filters .btn.showmore, #mixitup-container .filters #mixitup-showless").remove(),$("#mixitup-container .filters").append("<button class='btn showmore' type='button'>Show more...</button>"),$("#mixitup-container .filters").append("<a id='mixitup-showless'>Show less</a>"));12==t.projects.length&&($el=$("<button />"),$el.addClass("btn").attr("type","button").attr("id","mixitup-loadmore").text("Load more...").click(loadHomepage),$("#mixitup-container").append($el)),$("#mixitup-container .filters .btn.showmore").click(function(){return $("#mixitup-container .filters").addClass("show"),!1}),$("#mixitup-showless").click(function(){return $("#mixitup-container .filters").removeClass("show"),!1}),homepageData.mixer&&homepageData.mixer.destroy(),homepageData.mixer=mixitup($("#mixitup-container"),{selectors:{target:".portfolio-item"},animation:{duration:300}}),$("#loading").fadeOut()},error:function(){console.log("something went wrong.")}})}function showItem(t){$("#loading").fadeIn(),isNaN(t)&&(t=$(this).data("projectData").id),$.ajax({url:"http://www.behance.net/v2/projects/"+t,data:{client_id:config.client_id},dataType:"jsonp",success:function(e){var o=e.project;$.ajax({url:"http://www.behance.net/v2/projects/"+t+"/comments",data:{client_id:config.client_id,per_page:20,page:1},dataType:"jsonp",success:function(t){o.comments=t.comments;var e=$("#portfolioPopup").html(),a=Template7.compile(e)(o);$("#portfolioPopupModal").remove(),$("body").append(a),$("#portfolioPopupModal").popup(),$("#loading").hide()}})}})}var config={user_id:"Lightfarm",client_id:"THVb3iZMcUlK7Qzh2qgcbCcxk0seZlpV"};loadTmpl("popup");var homepageData={categories:[],categoriesCount:{},mixer:null,page:0};"homepage"==$("body").attr("id")&&loadHomepage(1),$.fn.popup=function(t,e){var o={backdrop:!0,click:!0,keyboard:!0},a=$.extend({},o,e);return"toggle"==t?(this.popup(this.is(":visible")?"hide":"show",e),this):(this.data({popupSettings:a}),this.find(".popup-backdrop").filter(function(){return!$(this).data("popupInit")}).data({popupInit:1}).click(function(){$(this).parent().data("popupSettings").click&&$(this).parent().popup("hide")}),"hide"==t?($("body").css("overflow","auto"),this.find(".popup-container").animate({top:0-1.5*this.find(".popup-container").height()}),this.find(".popup-backdrop").fadeOut(500,function(){$(this).parent().hide()})):"show"!=t&&t||($("body").css("overflow","hidden"),this.find(".popup-backdrop,.popup-container").hide(),this.show(),this.find(".popup-container").css({top:0-1.5*this.find(".popup-container").height()}).show().animate({top:"50%"}),this.data("popupSettings").backdrop?this.find(".popup-backdrop").fadeIn(500):this.find(".popup-backdrop").css({opacity:0}).show()),this)},$(document).keyup(function(t){27==t.keyCode&&$(".popup:visible").length&&$(".popup:visible").filter(function(){return $(this).data("popupSettings").keyboard}).popup("hide")}),"about"==$("body").attr("id")&&$.getJSON("/js/team.json",function(t){for(var e=$("#teamRows").html(),o=Template7.compile(e),a=[],i=0;i<t.length;i++){var p=t[i];p.lineBr=(i+1)%4==0,a.push(p)}var n=o({team:a});$("#teamRows").after(n),$("#loading").fadeOut()});